Number of sequences dropped: 0 out of 10000. (0.00%)

Row‑stochastic transition matrices (pred | true):
   0.6948  0.0781  0.0772  0.0723  0.0776  0.0000   |    0.7000  0.0750  0.0750  0.0750  0.0750  0.0000
   0.0757  0.7006  0.0743  0.0745  0.0749  0.0000   |    0.0750  0.7000  0.0750  0.0750  0.0750  0.0000
   0.0773  0.0780  0.6990  0.0729  0.0728  0.0000   |    0.0750  0.0750  0.7000  0.0750  0.0750  0.0000
   0.0757  0.0730  0.0759  0.6994  0.0759  0.0000   |    0.0750  0.0750  0.0750  0.7000  0.0750  0.0000
   0.0779  0.0745  0.0758  0.0740  0.6978  0.0000   |    0.0750  0.0750  0.0750  0.0750  0.7000  0.0000
   0.0000  0.0000  0.0000  0.0000  0.0000  0.0000   |    0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
P error max=0.0052  µ_diff=0.0012 mean_extra=0.0000 mean_diag=0.5819
[Classifier] epoch 1/30, loss=0.1231
[Classifier] epoch 2/30, loss=0.0952
[Classifier] epoch 3/30, loss=0.1454
[Classifier] epoch 4/30, loss=0.0636
[Classifier] epoch 5/30, loss=0.0587
[Classifier] epoch 6/30, loss=0.1465
[Classifier] epoch 7/30, loss=0.0583
[Classifier] epoch 8/30, loss=0.0937
[Classifier] epoch 9/30, loss=0.1058
[Classifier] epoch 10/30, loss=0.0877
[Classifier] epoch 11/30, loss=0.1175
[Classifier] epoch 12/30, loss=0.0948
[Classifier] epoch 13/30, loss=0.1839
[Classifier] epoch 14/30, loss=0.0563
[Classifier] epoch 15/30, loss=0.0936
[Classifier] epoch 16/30, loss=0.0757
[Classifier] epoch 17/30, loss=0.0836
[Classifier] epoch 18/30, loss=0.1099
[Classifier] epoch 19/30, loss=0.0777
[Classifier] epoch 20/30, loss=0.1300
[Classifier] epoch 21/30, loss=0.0671
[Classifier] epoch 22/30, loss=0.1143
[Classifier] epoch 23/30, loss=0.0551
[Classifier] epoch 24/30, loss=0.0640
[Classifier] epoch 25/30, loss=0.1107
[Classifier] epoch 26/30, loss=0.1007
[Classifier] epoch 27/30, loss=0.1125
[Classifier] epoch 28/30, loss=0.0228
[Classifier] epoch 29/30, loss=0.1174
[Classifier] epoch 30/30, loss=0.0673
[Classifier-Val]  loss = 0.0643  acc = 98.15% TP=9993 FP=196 TN=804 FN=7
[Time‐Cond Classifier] epoch 1/30, BCE=0.3840
[Time‐Cond Classifier] epoch 2/30, BCE=0.2179
[Time‐Cond Classifier] epoch 3/30, BCE=0.1811
[Time‐Cond Classifier] epoch 4/30, BCE=0.1780
[Time‐Cond Classifier] epoch 5/30, BCE=0.1762
[Time‐Cond Classifier] epoch 6/30, BCE=0.1785
[Time‐Cond Classifier] epoch 7/30, BCE=0.1755
[Time‐Cond Classifier] epoch 8/30, BCE=0.1716
[Time‐Cond Classifier] epoch 9/30, BCE=0.1747
[Time‐Cond Classifier] epoch 10/30, BCE=0.1739
[Time‐Cond Classifier] epoch 11/30, BCE=0.1673
[Time‐Cond Classifier] epoch 12/30, BCE=0.1738
[Time‐Cond Classifier] epoch 13/30, BCE=0.1719
[Time‐Cond Classifier] epoch 14/30, BCE=0.1728
[Time‐Cond Classifier] epoch 15/30, BCE=0.1695
[Time‐Cond Classifier] epoch 16/30, BCE=0.1713
[Time‐Cond Classifier] epoch 17/30, BCE=0.1750
[Time‐Cond Classifier] epoch 18/30, BCE=0.1702
[Time‐Cond Classifier] epoch 19/30, BCE=0.1669
[Time‐Cond Classifier] epoch 20/30, BCE=0.1718
[Time‐Cond Classifier] epoch 21/30, BCE=0.1712
[Time‐Cond Classifier] epoch 22/30, BCE=0.1661
[Time‐Cond Classifier] epoch 23/30, BCE=0.1741
[Time‐Cond Classifier] epoch 24/30, BCE=0.1699
[Time‐Cond Classifier] epoch 25/30, BCE=0.1695
[Time‐Cond Classifier] epoch 26/30, BCE=0.1640
[Time‐Cond Classifier] epoch 27/30, BCE=0.1665
[Time‐Cond Classifier] epoch 28/30, BCE=0.1642
[Time‐Cond Classifier] epoch 29/30, BCE=0.1595
[Time‐Cond Classifier] epoch 30/30, BCE=0.1616
[Time-Dependent Classifier-Val]  loss = 0.0817  acc = 97.73% TP=9995 FP=245 TN=755 FN=5
[Denoiser] epoch 1/20 trainCE = 0.9453
[Denoiser] epoch 2/20 trainCE = 0.6083
[Denoiser] epoch 3/20 trainCE = 0.6059
[Denoiser] epoch 4/20 trainCE = 0.6061
[Denoiser] epoch 5/20 trainCE = 0.5944
[Denoiser] epoch 6/20 trainCE = 0.6047
[Denoiser] epoch 7/20 trainCE = 0.6050
[Denoiser] epoch 8/20 trainCE = 0.6149
[Denoiser] epoch 9/20 trainCE = 0.5974
[Denoiser] epoch 10/20 trainCE = 0.6009
[Denoiser] epoch 11/20 trainCE = 0.6076
[Denoiser] epoch 12/20 trainCE = 0.5967
[Denoiser] epoch 13/20 trainCE = 0.6259
[Denoiser] epoch 14/20 trainCE = 0.5988
[Denoiser] epoch 15/20 trainCE = 0.6093
[Denoiser] epoch 16/20 trainCE = 0.6079
[Denoiser] epoch 17/20 trainCE = 0.6054
[Denoiser] epoch 18/20 trainCE = 0.6204
[Denoiser] epoch 19/20 trainCE = 0.5905
[Denoiser] epoch 20/20 trainCE = 0.6088
[Ratio‑TD-only-src] epoch 1/1, loss = 13.815687
[Ratio‑TD] epoch 1/1, loss = 18.664056
[Ratio on t-clf] epoch  1/1, MSE = 9.231297
[Ratio on t-clf + clean ratio] epoch  1/1, MSE = 10.619545
[Ratio-Reg] epoch 1/1  L_ratio=3.7252  L_cycle=55.1743  L_consistency=0.0000
[Vec-Ratio clf:0 and ratio:1] epoch 1/1, MSE = 2838.071557
Time taken to train ratio net vector: 2.66 seconds
[Vec-Ratio clf:1 and ratio:0] epoch 1/1, MSE = 2854.164580
Time taken to train ratio net vector: 2.46 seconds
[Vec-Ratio clf:0 and ratio:1] epoch 1/1, MSE = 2304.019222
Time taken to train ratio net vector: 2.53 seconds
[Vec-Ratio clf:0.25 and ratio:1] epoch 1/1, MSE = 3631.109548
Time taken to train ratio net vector: 4.14 seconds
[Ratio estimator] ratio vector on t-classifier trained


[Sampling] gamma=0, type=LRG, ratio_net=no ratio used
Sampling: 100%|██████████| 20/20 [00:03<00:00,  5.92step/s]
Sampled sequences (γ=0), type=LRG, ratio_net=no ratio used
Number of sequences dropped: 39 out of 4096. (0.95%)

Row‑stochastic transition matrices (pred | true):
   0.6153  0.1026  0.0866  0.0930  0.1025  0.0000   |    0.7000  0.0750  0.0750  0.0750  0.0750  0.0000
   0.0909  0.6270  0.0953  0.0930  0.0939  0.0000   |    0.0750  0.7000  0.0750  0.0750  0.0750  0.0000
   0.0795  0.1073  0.6231  0.0895  0.1005  0.0001   |    0.0750  0.0750  0.7000  0.0750  0.0750  0.0000
   0.0784  0.1003  0.0794  0.6394  0.1025  0.0000   |    0.0750  0.0750  0.0750  0.7000  0.0750  0.0000
   0.0964  0.1000  0.1000  0.0960  0.6076  0.0000   |    0.0750  0.0750  0.0750  0.0750  0.7000  0.0000
   0.0000  0.2500  0.2500  0.2500  0.2500  0.0000   |    0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
P error max=0.2500  µ_diff=0.0493 mean_extra=0.0909 mean_diag=0.5187

[Sampling] gamma=1, type=LRG, ratio_net=ratio vector on t-classifier
Sampling: 100%|██████████| 20/20 [00:18<00:00,  1.06step/s]
Sampled sequences (γ=1), type=LRG, ratio_net=ratio vector on t-classifier
Traceback (most recent call last):
  File "/Users/juliankleutgens/PycharmProjects/ratio_estimation_synthetic/main2.py", line 556, in <module>
    main()
  File "/Users/juliankleutgens/PycharmProjects/ratio_estimation_synthetic/main2.py", line 541, in main
    P_est = estimate_transition_matrix(samples.cpu(), config.vocab_size)
  File "/Users/juliankleutgens/PycharmProjects/ratio_estimation_synthetic/data.py", line 318, in estimate_transition_matrix
    raise ValueError("No valid sequences after mask filtering.")
ValueError: No valid sequences after mask filtering.
