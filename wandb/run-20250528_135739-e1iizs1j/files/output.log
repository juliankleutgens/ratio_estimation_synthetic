Number of sequences dropped: 0 out of 10000. (0.00%)

Row‑stochastic transition matrices (pred | true):
   0.7012  0.0741  0.0757  0.0744  0.0745  0.0000   |    0.7000  0.0750  0.0750  0.0750  0.0750  0.0000
   0.0755  0.7016  0.0741  0.0741  0.0748  0.0000   |    0.0750  0.7000  0.0750  0.0750  0.0750  0.0000
   0.0748  0.0733  0.7011  0.0741  0.0767  0.0000   |    0.0750  0.0750  0.7000  0.0750  0.0750  0.0000
   0.0748  0.0764  0.0758  0.6984  0.0746  0.0000   |    0.0750  0.0750  0.0750  0.7000  0.0750  0.0000
   0.0750  0.0742  0.0762  0.0752  0.6994  0.0000   |    0.0750  0.0750  0.0750  0.0750  0.7000  0.0000
   0.0000  0.0000  0.0000  0.0000  0.0000  0.0000   |    0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
[Data] P_est error: max 0.0017  ‖·‖₁=0.0049 mean_diag=0.5836
[Classifier] epoch 1/30, loss=0.0245
[Classifier] epoch 2/30, loss=0.0020
[Classifier] epoch 3/30, loss=0.0018
[Classifier] epoch 4/30, loss=0.0019
[Classifier] epoch 5/30, loss=0.0268
[Classifier] epoch 6/30, loss=0.0278
[Classifier] epoch 7/30, loss=0.0019
[Classifier] epoch 8/30, loss=0.0515
[Classifier] epoch 9/30, loss=0.0017
[Classifier] epoch 10/30, loss=0.0017
[Classifier] epoch 11/30, loss=0.0019
[Classifier] epoch 12/30, loss=0.0018
[Classifier] epoch 13/30, loss=0.0271
[Classifier] epoch 14/30, loss=0.0018
[Classifier] epoch 15/30, loss=0.0017
[Classifier] epoch 16/30, loss=0.0011
[Classifier] epoch 17/30, loss=0.0023
[Classifier] epoch 18/30, loss=0.0013
[Classifier] epoch 19/30, loss=0.0020
[Classifier] epoch 20/30, loss=0.0011
[Classifier] epoch 21/30, loss=0.0017
[Classifier] epoch 22/30, loss=0.0012
[Classifier] epoch 23/30, loss=0.0010
[Classifier] epoch 24/30, loss=0.0206
[Classifier] epoch 25/30, loss=0.0013
[Classifier] epoch 26/30, loss=0.0020
[Classifier] epoch 27/30, loss=0.0009
[Classifier] epoch 28/30, loss=0.0013
[Classifier] epoch 29/30, loss=0.0029
[Classifier] epoch 30/30, loss=0.0008
[Classifier-Val]  loss = 0.0064  acc = 99.85% TP=10000 FP=16 TN=984 FN=0
[Time‐Cond Classifier] epoch 1/30, BCE=0.3353
[Time‐Cond Classifier] epoch 2/30, BCE=0.1340
[Time‐Cond Classifier] epoch 3/30, BCE=0.1084
[Time‐Cond Classifier] epoch 4/30, BCE=0.1012
[Time‐Cond Classifier] epoch 5/30, BCE=0.1096
[Time‐Cond Classifier] epoch 6/30, BCE=0.0992
[Time‐Cond Classifier] epoch 7/30, BCE=0.1056
[Time‐Cond Classifier] epoch 8/30, BCE=0.1026
[Time‐Cond Classifier] epoch 9/30, BCE=0.1101
[Time‐Cond Classifier] epoch 10/30, BCE=0.1057
[Time‐Cond Classifier] epoch 11/30, BCE=0.1080
[Time‐Cond Classifier] epoch 12/30, BCE=0.1004
[Time‐Cond Classifier] epoch 13/30, BCE=0.1037
[Time‐Cond Classifier] epoch 14/30, BCE=0.1122
[Time‐Cond Classifier] epoch 15/30, BCE=0.1024
[Time‐Cond Classifier] epoch 16/30, BCE=0.1013
[Time‐Cond Classifier] epoch 17/30, BCE=0.0995
[Time‐Cond Classifier] epoch 18/30, BCE=0.1083
[Time‐Cond Classifier] epoch 19/30, BCE=0.1083
[Time‐Cond Classifier] epoch 20/30, BCE=0.1029
[Time‐Cond Classifier] epoch 21/30, BCE=0.1118
[Time‐Cond Classifier] epoch 22/30, BCE=0.1024
[Time‐Cond Classifier] epoch 23/30, BCE=0.1046
[Time‐Cond Classifier] epoch 24/30, BCE=0.1101
[Time‐Cond Classifier] epoch 25/30, BCE=0.1021
[Time‐Cond Classifier] epoch 26/30, BCE=0.1060
[Time‐Cond Classifier] epoch 27/30, BCE=0.1030
[Time‐Cond Classifier] epoch 28/30, BCE=0.0976
[Time‐Cond Classifier] epoch 29/30, BCE=0.1065
[Time‐Cond Classifier] epoch 30/30, BCE=0.1010
[Time-Dependent Classifier-Val]  loss = 0.0100  acc = 99.85% TP=10000 FP=17 TN=983 FN=0
[Denoiser] epoch 1/20 trainCE = 0.9307
[Denoiser] epoch 2/20 trainCE = 0.6334
[Denoiser] epoch 3/20 trainCE = 0.6059
[Denoiser] epoch 4/20 trainCE = 0.6107
[Denoiser] epoch 5/20 trainCE = 0.5929
[Denoiser] epoch 6/20 trainCE = 0.6012
[Denoiser] epoch 7/20 trainCE = 0.6047
[Denoiser] epoch 8/20 trainCE = 0.6090
[Denoiser] epoch 9/20 trainCE = 0.5942
[Denoiser] epoch 10/20 trainCE = 0.5967
[Denoiser] epoch 11/20 trainCE = 0.6034
[Denoiser] epoch 12/20 trainCE = 0.5933
[Denoiser] epoch 13/20 trainCE = 0.6205
[Denoiser] epoch 14/20 trainCE = 0.5939
[Denoiser] epoch 15/20 trainCE = 0.6061
[Denoiser] epoch 16/20 trainCE = 0.6026
[Denoiser] epoch 17/20 trainCE = 0.6010
[Denoiser] epoch 18/20 trainCE = 0.6143
[Denoiser] epoch 19/20 trainCE = 0.5886
[Denoiser] epoch 20/20 trainCE = 0.6062
[Ratio‑TD-only-src] epoch 1/1, loss = 26.653121
[Ratio‑TD] epoch 1/1, loss = 34.579535
[Ratio on t-clf + reconstruction loss] epoch  1/1, MSE = 36.417658
[Ratio on t-clf] epoch  1/30, MSE = 24.807297
[Ratio on t-clf] epoch  2/30, MSE = 5.389183
[Ratio on t-clf] epoch  3/30, MSE = 1.429558
[Ratio on t-clf] epoch  4/30, MSE = 1.359021
[Ratio on t-clf] epoch  5/30, MSE = 1.360861
[Ratio on t-clf] epoch  6/30, MSE = 1.317493
[Ratio on t-clf] epoch  7/30, MSE = 1.313023
[Ratio on t-clf] epoch  8/30, MSE = 1.330864
[Ratio on t-clf] epoch  9/30, MSE = 1.281294
[Ratio on t-clf] epoch 10/30, MSE = 1.294555
[Ratio on t-clf] epoch 11/30, MSE = 1.308785
[Ratio on t-clf] epoch 12/30, MSE = 1.285287
[Ratio on t-clf] epoch 13/30, MSE = 1.268394
[Ratio on t-clf] epoch 14/30, MSE = 1.307459
[Ratio on t-clf] epoch 15/30, MSE = 1.274015
[Ratio on t-clf] epoch 16/30, MSE = 1.294988
[Ratio on t-clf] epoch 17/30, MSE = 1.287753
[Ratio on t-clf] epoch 18/30, MSE = 1.280131
[Ratio on t-clf] epoch 19/30, MSE = 1.295640
[Ratio on t-clf] epoch 20/30, MSE = 1.298029
[Ratio on t-clf] epoch 21/30, MSE = 1.283957
[Ratio on t-clf] epoch 22/30, MSE = 1.318667
[Ratio on t-clf] epoch 23/30, MSE = 1.269227
[Ratio on t-clf] epoch 24/30, MSE = 1.308302
[Ratio on t-clf] epoch 25/30, MSE = 1.309412
[Ratio on t-clf] epoch 26/30, MSE = 1.265225
[Ratio on t-clf] epoch 27/30, MSE = 1.271768
[Ratio on t-clf] epoch 28/30, MSE = 1.286469
[Ratio on t-clf] epoch 29/30, MSE = 1.284970
[Ratio on t-clf] epoch 30/30, MSE = 1.296552
[Ratio-Reg] epoch 1/1  L_ratio=6.4493  L_cycle=142.6743  L_consistency=0.0000
[Vec-Ratio clf:0 and ratio:1] epoch 1/30, MSE = 2538.148771
[Vec-Ratio clf:0 and ratio:1] epoch 2/30, MSE = 151.282547
[Vec-Ratio clf:0 and ratio:1] epoch 3/30, MSE = 11.983132
[Vec-Ratio clf:0 and ratio:1] epoch 4/30, MSE = 3.529303
[Vec-Ratio clf:0 and ratio:1] epoch 5/30, MSE = 2.267165
[Vec-Ratio clf:0 and ratio:1] epoch 6/30, MSE = 1.773830
[Vec-Ratio clf:0 and ratio:1] epoch 7/30, MSE = 1.374564
[Vec-Ratio clf:0 and ratio:1] epoch 8/30, MSE = 1.140442
[Vec-Ratio clf:0 and ratio:1] epoch 9/30, MSE = 0.959140
[Vec-Ratio clf:0 and ratio:1] epoch 10/30, MSE = 0.867146
[Vec-Ratio clf:0 and ratio:1] epoch 11/30, MSE = 0.780100
[Vec-Ratio clf:0 and ratio:1] epoch 12/30, MSE = 0.704713
[Vec-Ratio clf:0 and ratio:1] epoch 13/30, MSE = 0.652182
[Vec-Ratio clf:0 and ratio:1] epoch 14/30, MSE = 0.615502
[Vec-Ratio clf:0 and ratio:1] epoch 15/30, MSE = 0.576723
[Vec-Ratio clf:0 and ratio:1] epoch 16/30, MSE = 0.549230
[Vec-Ratio clf:0 and ratio:1] epoch 17/30, MSE = 0.520822
[Vec-Ratio clf:0 and ratio:1] epoch 18/30, MSE = 0.495402
[Vec-Ratio clf:0 and ratio:1] epoch 19/30, MSE = 0.465722
[Vec-Ratio clf:0 and ratio:1] epoch 20/30, MSE = 0.453266
[Vec-Ratio clf:0 and ratio:1] epoch 21/30, MSE = 0.438377
[Vec-Ratio clf:0 and ratio:1] epoch 22/30, MSE = 0.420286
[Vec-Ratio clf:0 and ratio:1] epoch 23/30, MSE = 0.405115
[Vec-Ratio clf:0 and ratio:1] epoch 24/30, MSE = 0.385432
[Vec-Ratio clf:0 and ratio:1] epoch 25/30, MSE = 0.377197
[Vec-Ratio clf:0 and ratio:1] epoch 26/30, MSE = 0.362568
[Vec-Ratio clf:0 and ratio:1] epoch 27/30, MSE = 0.357738
[Vec-Ratio clf:0 and ratio:1] epoch 28/30, MSE = 0.351038
[Vec-Ratio clf:0 and ratio:1] epoch 29/30, MSE = 0.330817
[Vec-Ratio clf:0 and ratio:1] epoch 30/30, MSE = 0.320394
Time taken to train ratio net vector: 185.29 seconds
[Vec-Ratio clf:0 and ratio:1] epoch 1/30, MSE = 2469.404903
[Vec-Ratio clf:0 and ratio:1] epoch 2/30, MSE = 129.259816
[Vec-Ratio clf:0 and ratio:1] epoch 3/30, MSE = 14.045369
[Vec-Ratio clf:0 and ratio:1] epoch 4/30, MSE = 4.012055
[Vec-Ratio clf:0 and ratio:1] epoch 5/30, MSE = 2.529245
[Vec-Ratio clf:0 and ratio:1] epoch 6/30, MSE = 1.979213
[Vec-Ratio clf:0 and ratio:1] epoch 7/30, MSE = 1.673921
[Vec-Ratio clf:0 and ratio:1] epoch 8/30, MSE = 1.346366
[Vec-Ratio clf:0 and ratio:1] epoch 9/30, MSE = 1.155314
[Vec-Ratio clf:0 and ratio:1] epoch 10/30, MSE = 0.986668
[Vec-Ratio clf:0 and ratio:1] epoch 11/30, MSE = 0.863004
[Vec-Ratio clf:0 and ratio:1] epoch 12/30, MSE = 0.775063
[Vec-Ratio clf:0 and ratio:1] epoch 13/30, MSE = 0.694972
[Vec-Ratio clf:0 and ratio:1] epoch 14/30, MSE = 0.658603
[Vec-Ratio clf:0 and ratio:1] epoch 15/30, MSE = 0.611635
[Vec-Ratio clf:0 and ratio:1] epoch 16/30, MSE = 0.578840
[Vec-Ratio clf:0 and ratio:1] epoch 17/30, MSE = 0.549445
[Vec-Ratio clf:0 and ratio:1] epoch 18/30, MSE = 0.526805
[Vec-Ratio clf:0 and ratio:1] epoch 19/30, MSE = 0.501205
[Vec-Ratio clf:0 and ratio:1] epoch 20/30, MSE = 0.479245
[Vec-Ratio clf:0 and ratio:1] epoch 21/30, MSE = 0.457189
[Vec-Ratio clf:0 and ratio:1] epoch 22/30, MSE = 0.451822
[Vec-Ratio clf:0 and ratio:1] epoch 23/30, MSE = 0.425663
[Vec-Ratio clf:0 and ratio:1] epoch 24/30, MSE = 0.414448
[Vec-Ratio clf:0 and ratio:1] epoch 25/30, MSE = 0.396970
[Vec-Ratio clf:0 and ratio:1] epoch 26/30, MSE = 0.382738
[Vec-Ratio clf:0 and ratio:1] epoch 27/30, MSE = 0.375472
[Vec-Ratio clf:0 and ratio:1] epoch 28/30, MSE = 0.358123
[Vec-Ratio clf:0 and ratio:1] epoch 29/30, MSE = 0.358302
[Vec-Ratio clf:0 and ratio:1] epoch 30/30, MSE = 0.344955
Time taken to train ratio net vector: 186.81 seconds
Time taken to train ratio net vector: 0.04 seconds
[Ratio estimator] ratio net scaler on t-classifer trained

[Ratio estimator] ratio net vector on t-classifer trained

[Ratio estimator] ratio net vector on pre-trained ratio trained

[Ratio estimator] vector on pre-trained ratio + t-clas trained


[Sampling] gamma=0, type=LRG, ratio_net=no ratio used
Sampling: 100%|██████████| 20/20 [00:04<00:00,  4.84step/s]
Sampled sequences (γ=0), type=LRG, ratio_net=no ratio used
Number of sequences dropped: 54 out of 2048. (2.64%)

Row‑stochastic transition matrices (pred | true):
   0.5758  0.0943  0.1090  0.1197  0.1012  0.0001   |    0.7000  0.0750  0.0750  0.0750  0.0750  0.0000
   0.0999  0.5943  0.0957  0.1054  0.1045  0.0001   |    0.0750  0.7000  0.0750  0.0750  0.0750  0.0000
   0.0988  0.0923  0.5796  0.1219  0.1074  0.0001   |    0.0750  0.0750  0.7000  0.0750  0.0750  0.0000
   0.0990  0.0857  0.1037  0.6189  0.0927  0.0001   |    0.0750  0.0750  0.0750  0.7000  0.0750  0.0000
   0.1107  0.0981  0.1107  0.1079  0.5727  0.0000   |    0.0750  0.0750  0.0750  0.0750  0.7000  0.0000
   0.0000  0.2500  0.5000  0.2500  0.0000  0.0000   |    0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
P error max=0.5000  ‖·‖₁=0.6753 mean_diag=0.4902 (t=4.2s)

[Sampling] gamma=1, type=LRG, ratio_net=ratio net scaler on t-classifer
Sampling: 100%|██████████| 20/20 [06:58<00:00, 20.91s/step]
Sampled sequences (γ=1), type=LRG, ratio_net=ratio net scaler on t-classifer
Number of sequences dropped: 44 out of 2048. (2.15%)

Row‑stochastic transition matrices (pred | true):
   0.5144  0.0770  0.0991  0.1161  0.0979  0.0955   |    0.4000  0.1200  0.1200  0.1200  0.1200  0.1200
   0.0869  0.5437  0.0920  0.1091  0.0958  0.0725   |    0.1200  0.4000  0.1200  0.1200  0.1200  0.1200
   0.0889  0.0774  0.5229  0.1112  0.0917  0.1078   |    0.1200  0.1200  0.4000  0.1200  0.1200  0.1200
   0.0856  0.0706  0.0898  0.5540  0.0910  0.1090   |    0.1200  0.1200  0.1200  0.4000  0.1200  0.1200
   0.0959  0.0868  0.0997  0.1069  0.5090  0.1016   |    0.1200  0.1200  0.1200  0.1200  0.4000  0.1200
   0.1475  0.1021  0.1945  0.2094  0.1694  0.1771   |    0.1200  0.1200  0.1200  0.1200  0.1200  0.4000
P error max=0.2229  ‖·‖₁=0.4139 mean_diag=0.4702 (t=418.1s)

[Sampling] gamma=1, type=LRG, ratio_net=ratio net vector on t-classifer
Sampling: 100%|██████████| 20/20 [01:04<00:00,  3.25s/step]
Sampled sequences (γ=1), type=LRG, ratio_net=ratio net vector on t-classifer
Number of sequences dropped: 80 out of 2048. (3.91%)

Row‑stochastic transition matrices (pred | true):
   0.5558  0.0711  0.1079  0.0982  0.0925  0.0745   |    0.4000  0.1200  0.1200  0.1200  0.1200  0.1200
   0.0733  0.5771  0.1040  0.0991  0.0820  0.0645   |    0.1200  0.4000  0.1200  0.1200  0.1200  0.1200
   0.0718  0.0700  0.5787  0.0935  0.0780  0.1080   |    0.1200  0.1200  0.4000  0.1200  0.1200  0.1200
   0.0686  0.0688  0.0903  0.5673  0.0697  0.1353   |    0.1200  0.1200  0.1200  0.4000  0.1200  0.1200
   0.0890  0.0814  0.1078  0.1044  0.5320  0.0854   |    0.1200  0.1200  0.1200  0.1200  0.4000  0.1200
   0.1093  0.0922  0.2300  0.2692  0.1205  0.1787   |    0.1200  0.1200  0.1200  0.1200  0.1200  0.4000
P error max=0.2213  ‖·‖₁=0.5008 mean_diag=0.4983 (t=65.0s)

[Sampling] gamma=1, type=LRG, ratio_net=ratio net vector on pre-trained ratio
Sampling: 100%|██████████| 20/20 [01:03<00:00,  3.19s/step]
Sampled sequences (γ=1), type=LRG, ratio_net=ratio net vector on pre-trained ratio
Number of sequences dropped: 127 out of 2048. (6.20%)

Row‑stochastic transition matrices (pred | true):
   0.5311  0.0801  0.0869  0.1192  0.1006  0.0823   |    0.4000  0.1200  0.1200  0.1200  0.1200  0.1200
   0.0856  0.5256  0.0996  0.1091  0.0988  0.0814   |    0.1200  0.4000  0.1200  0.1200  0.1200  0.1200
   0.0866  0.0783  0.5216  0.1099  0.0803  0.1233   |    0.1200  0.1200  0.4000  0.1200  0.1200  0.1200
   0.0821  0.0638  0.0811  0.5775  0.0819  0.1135   |    0.1200  0.1200  0.1200  0.4000  0.1200  0.1200
   0.0946  0.0791  0.0903  0.1170  0.5178  0.1012   |    0.1200  0.1200  0.1200  0.1200  0.4000  0.1200
   0.1241  0.1005  0.1942  0.2428  0.1570  0.1815   |    0.1200  0.1200  0.1200  0.1200  0.1200  0.4000
P error max=0.2185  ‖·‖₁=0.4325 mean_diag=0.4758 (t=63.8s)

[Sampling] gamma=1, type=LRG, ratio_net=vector on pre-trained ratio + t-clas
Sampling: 100%|██████████| 20/20 [01:03<00:00,  3.18s/step]
Sampled sequences (γ=1), type=LRG, ratio_net=vector on pre-trained ratio + t-clas
Traceback (most recent call last):
  File "/Users/juliankleutgens/PycharmProjects/ratio_estimation_synthetic/main2.py", line 530, in <module>
    main()
  File "/Users/juliankleutgens/PycharmProjects/ratio_estimation_synthetic/main2.py", line 514, in main
    P_est = estimate_transition_matrix(samples.cpu(), config.vocab_size)
  File "/Users/juliankleutgens/PycharmProjects/ratio_estimation_synthetic/data.py", line 316, in estimate_transition_matrix
    raise ValueError("No valid sequences after mask filtering.")
ValueError: No valid sequences after mask filtering.
